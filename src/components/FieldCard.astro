---
import { Icon } from "astro-icon/components";
import ResultStats from "./ResultStats.astro";
import { formatDate } from "@/lib/utils/dateUtils";
interface Props {
  field: {
    id: string;
    name: string;
    city: string;
    stats: {
      totalMatches: number;
      lightWins: number;
      darkWins: number;
      draws: number;
      lastMatchDate: string | null;
    };
  };
}

const { field } = Astro.props;
const { stats } = field;
---

<div
  class="card bg-base-100 border-base-200 group relative h-full overflow-hidden rounded-xl border shadow-md"
>
  <Icon
    name="material-symbols:stadium-rounded"
    class="text-base-content/5 pointer-events-none absolute -right-6 -bottom-6 h-32 w-32 -rotate-12"
  />

  <div class="card-body">
    {/* ENCABEZADO: Título y Ciudad */}
    <div class="flex items-start justify-between">
      <div class="flex gap-3">
        <Icon
          name="material-symbols:location-on"
          class="text-error"
          size={24}
        />
        <div>
          <h2 class="card-title text-xl leading-tight font-bold">
            {field.name}
          </h2>
          <p class="text-base-content/60 text-sm font-medium">{field.city}</p>
        </div>
      </div>

      {/* Badge de PJ */}
      <div class="badge badge-neutral shrink-0 rounded-xl font-bold">
        {stats.totalMatches} PJ
      </div>
    </div>

    <div class="divider"></div>

    {/* ESTADÍSTICAS */}
    <div>
      <ResultStats
        lightWins={stats.lightWins}
        darkWins={stats.darkWins}
        draws={stats.draws}
      />
    </div>

    <div class="divider m-0"></div>

    {/* FOOTER: Última Actividad */}
    <div
      class="text-base-content/60 relative z-10 flex items-center justify-between text-xs"
    >
      <span class="flex items-center gap-1">
        <Icon name="material-symbols:calendar-today" size={14} /> Último juego:
      </span>
      <span class="font-bold">
        {
          stats.lastMatchDate
            ? formatDate(stats.lastMatchDate, "compact")
            : "Sin actividad"
        }
      </span>
    </div>
  </div>
</div>
